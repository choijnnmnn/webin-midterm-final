<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•œê¸€ ìˆ˜í™” í•™ìŠµ - ì†ê°€ë½ìœ¼ë¡œ ì´ë¦„ ë°°ìš°ê¸°</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        @font-face {
            font-family: 'Paperozi';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2408-3@1.0/Paperlogy-1Thin.woff2') format('woff2');
            font-weight: 100;
            font-display: swap;
        }

        @font-face {
            font-family: 'Paperozi';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2408-3@1.0/Paperlogy-2ExtraLight.woff2') format('woff2');
            font-weight: 200;
            font-display: swap;
        }

        @font-face {
            font-family: 'Paperozi';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2408-3@1.0/Paperlogy-3Light.woff2') format('woff2');
            font-weight: 300;
            font-display: swap;
        }

        @font-face {
            font-family: 'Paperozi';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2408-3@1.0/Paperlogy-4Regular.woff2') format('woff2');
            font-weight: 400;
            font-display: swap;
        }

        @font-face {
            font-family: 'Paperozi';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2408-3@1.0/Paperlogy-5Medium.woff2') format('woff2');
            font-weight: 500;
            font-display: swap;
        }

        @font-face {
            font-family: 'Paperozi';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2408-3@1.0/Paperlogy-6SemiBold.woff2') format('woff2');
            font-weight: 600;
            font-display: swap;
        }

        @font-face {
            font-family: 'Paperozi';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2408-3@1.0/Paperlogy-7Bold.woff2') format('woff2');
            font-weight: 700;
            font-display: swap;
        }

        @font-face {
            font-family: 'Paperozi';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2408-3@1.0/Paperlogy-8ExtraBold.woff2') format('woff2');
            font-weight: 800;
            font-display: swap;
        }

        @font-face {
            font-family: 'Paperozi';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2408-3@1.0/Paperlogy-9Black.woff2') format('woff2');
            font-weight: 900;
            font-display: swap;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }

        /* í˜„ì¬ ìëª¨ìŒ íŒì¸(pop-in) ì• ë‹ˆë©”ì´ì…˜ */
@keyframes popIn {
    0% { transform: scale(0.8); opacity: 0; }
    70% { transform: scale(1.1); opacity: 1; }
    100% { transform: scale(1.0); opacity: 1; }
}

.pop-in-animation {
    /* ê¸°ì¡´ í…ìŠ¤íŠ¸ê°€ ì ì‹œ ì‚¬ë¼ì§€ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´ 0.1ì´ˆ í›„ ì‹œì‘ */
    animation: popIn 0.4s ease-out 0.1s both;
}
        body { 
            font-family: 'Noto Sans KR', sans-serif; 
            background: linear-gradient(125deg, #B3B0FF, #fdfaff, #F2D6FF);
    background-size: 400% 400%;
    animation: gradientBG 20s ease infinite;
    min-height: 100vh;
    color: #333;

        }
        @keyframes gradientBG {
    0% {
        background-position: 0% 50%;
    }
    50% {
        background-position: 100% 50%;
    }
    100% {
        background-position: 0% 50%;}
    }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .header { 
            text-align: center; 
            margin-bottom: 40px; 
            color: #2c3e50;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .header h1 { 
            font-family: 'Paperozi', 'Noto Sans KR', sans-serif;
            font-size: 3.5em; 
            margin-bottom: 15px; 
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .header p { 
            font-family: 'Paperozi', 'Noto Sans KR', sans-serif;
            font-size: 1.3em; 
            opacity: 0.8; 
            font-weight: 300;
        }
        .main-content { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 40px; 
            margin-bottom: 40px; 
        }
        .left-panel, .right-panel { 
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    
    /* border: 1px solid rgba(255, 255, 255, 0.1); <- ì´ ì†ì„±ì„ ì£¼ì„ ì²˜ë¦¬í•˜ê±°ë‚˜ ì‚­ì œí•©ë‹ˆë‹¤. */
    border-radius: 25px; 
    padding: 35px;
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
    transition: all 0.3s ease;

    /* â–¼ ì•„ë˜ 3ì¤„ì„ ì¶”ê°€í•©ë‹ˆë‹¤. â–¼ */
    border: 1px solid transparent; /* í…Œë‘ë¦¬ë¥¼ íˆ¬ëª…í•˜ê²Œ ì„¤ì • */
    background-clip: padding-box; /* ë°°ê²½ì´ í…Œë‘ë¦¬ ì•ˆìª½(íŒ¨ë”©ë°•ìŠ¤)ì—ë§Œ ë³´ì´ë„ë¡ */
    position: relative; /* ê°€ìƒ ìš”ì†Œë¥¼ ìœ„í•œ ê¸°ì¤€ì  */
}

/* â–¼ ì•„ë˜ ì„ íƒìë¥¼ ìƒˆë¡œ ì¶”ê°€í•©ë‹ˆë‹¤. â–¼ */
.left-panel::before, .right-panel::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    z-index: -1;
    margin: -1px; /* í…Œë‘ë¦¬ ë‘ê»˜(1px)ë§Œí¼ ë°–ìœ¼ë¡œ */
    border-radius: inherit; /* ë¶€ëª¨ì˜ border-radius ìƒì† */
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.4), rgba(118, 75, 162, 0.3));
}
        .left-panel:hover, .right-panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px 0 rgba(31, 38, 135, 0.3);
        }
        .video-container { position: relative; display: inline-block; margin-bottom: 20px; border-radius: 15px; overflow: hidden;  border: 3px solid #e0e0e0; }
        #video { width: 100%; max-width: 500px; height: auto; background: #000; transform: scaleX(-1); }
        #canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; transform: scaleX(-1); }
        .controls { text-align: center; margin: 20px 0; }
        button { 
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: #2c3e50; 
            padding: 15px 30px; 
            margin: 0 10px; 
            border-radius: 25px; 
            cursor: pointer; 
            font-size: 16px; 
            font-weight: 600; 
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px 0 rgba(31, 38, 135, 0.2);
            font-family: 'Noto Sans KR', sans-serif;
        }
        button:hover { 
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-3px); 
            box-shadow: 0 8px 25px 0 rgba(31, 38, 135, 0.3);
        }
        button:disabled { 
            background: rgba(189, 195, 199, 0.3); 
            cursor: not-allowed; 
            transform: none; 
            opacity: 0.6;
        }
        .input-section { 
            margin-bottom: 30px; 
            transition: all 0.5s ease;
        }
        .input-section h3 { 
            font-family: 'Paperozi', 'Noto Sans KR', sans-serif;
            color: #2c3e50; 
            margin-bottom: 20px; 
            font-size: 1.6em; 
            font-weight: 500;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        .name-input { 
            width: 100%; 
            padding: 18px 20px; 
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: 15px; 
            font-size: 18px; 
            margin-bottom: 20px; 
            text-align: center;
            font-family: 'Noto Sans KR', sans-serif;
            color: #2c3e50;
            box-shadow: 0 4px 15px 0 rgba(31, 38, 135, 0.1);
            transition: all 0.3s ease;
        }
        .name-input:focus { 
            outline: none; 
            border-color: rgba(102, 126, 234, 0.6);
            background: rgba(255, 255, 255, 0.4);
            box-shadow: 0 8px 25px 0 rgba(31, 38, 135, 0.2);
        }
        .name-input::placeholder {
            color: rgba(44, 62, 80, 0.6);
            font-weight: 400;
        }
    
        .hand-option-section { 
            margin-bottom: 25px; 
            text-align: center; 
            transition: all 0.5s ease;
        }
        .hand-option-section h3 { 
            font-family: 'Paperozi', 'Noto Sans KR', sans-serif;
            color: #2c3e50; 
            margin-bottom: 20px; 
            font-size: 1.6em; 
            font-weight: 500;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        .hand-option-section label { 
            margin: 0 15px; 
            font-size: 16px; 
            cursor: pointer;
            font-weight: 500;
            color: #2c3e50;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            transition: all 0.3s ease;
            display: inline-block;
        }
        .hand-option-section label:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        .hand-option-section input[type="radio"] {
            margin-right: 8px;
            accent-color: #667eea;
        }
        
        /* í•™ìŠµ ì‹œì‘ í›„ ë ˆì´ì•„ì›ƒ ë³€ê²½ */
        .learning-started .input-section,
        .learning-started .hand-option-section {
            order: 3; /* ì•„ë˜ë¡œ ì´ë™ */
            margin-bottom: 15px;
        }
        
        .learning-started .learning-section {
            order: 1; /* ìœ„ë¡œ ì´ë™ */
        }
        
        .learning-started .sign-guide {
            order: 2; /* ë‘ ë²ˆì§¸ë¡œ ì´ë™ */
        }
        
        .right-panel {
            display: flex;
            flex-direction: column;
        }
        .decomposed-letters { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 15px; 
            justify-content: center; 
            margin: 25px 0; 
        }
        .letter-card { 
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px; 
            padding: 20px; 
            text-align: center; 
            min-width: 70px; 
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px 0 rgba(31, 38, 135, 0.05);
        }
        .letter-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px 0 rgba(31, 38, 135, 0.2);
        }
        .letter-card.current { 
            background: rgba(33, 150, 243, 0.3);
            border-color: rgba(33, 150, 243, 0.6);
            transform: scale(1.1);
            box-shadow: 0 8px 25px 0 rgba(33, 150, 243, 0.3);
        }
        .letter-card.completed { 
            background: rgba(76, 175, 80, 0.3);
            border-color: rgba(76, 175, 80, 0.6);
        }
        .letter-card h4 { 
            font-family: 'Paperozi', 'Noto Sans KR', sans-serif;
            font-size: 1.3em; 
            margin-bottom: 8px; 
            font-weight: 500;
            color: #2c3e50;
        }
        .letter-card p { 
            font-family: 'Paperozi', 'Noto Sans KR', sans-serif;
            font-size: 0.9em; 
            color: rgba(44, 62, 80, 0.7);
            font-weight: 300;
        }
        .learning-section { 
            margin-top: 35px; 
        }
        .current-letter { 
            text-align: center; 
            margin: 25px 0; 
        }
        .current-letter h2 { 
            font-family: 'Paperozi', 'Noto Sans KR', sans-serif;
            font-size: 3.5em; 
            color: #e74c3c; 
            margin-bottom: 15px; 
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .current-letter p { 
            font-family: 'Paperozi', 'Noto Sans KR', sans-serif;
            font-size: 1.3em; 
            color: rgba(44, 62, 80, 0.8);
            font-weight: 300;
        }
        .sign-guide { 
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px; 
            padding: 25px; 
            margin: 25px 0; 
            box-shadow: 0 4px 15px 0 rgba(31, 38, 135, 0.05);
        }
        .sign-guide h4 { 
            font-family: 'Paperozi', 'Noto Sans KR', sans-serif;
            color: #2c3e50; 
            margin-bottom: 20px; 
            font-size: 1.4em;
            font-weight: 500;
        }
        .sign-guide ul { 
            list-style: none; 
            padding: 0; 
        }
        .sign-guide li { 
            font-family: 'Paperozi', 'Noto Sans KR', sans-serif;
            padding: 12px 0; 
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            font-weight: 300;
            color: #2c3e50;
        }
        .sign-guide li:last-child { 
            border-bottom: none; 
        }
        .feedback-section { 
            margin: 25px 0; 
            text-align: center; 
            height: 60px; 
        }
        .feedback { 
            font-family: 'Paperozi', 'Noto Sans KR', sans-serif;
            padding: 18px 25px; 
            border-radius: 15px; 
            font-size: 1.2em; 
            font-weight: 300; 
            margin: 15px 0;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 15px 0 rgba(31, 38, 135, 0.2);
        }
        .feedback.correct { 
            background: rgba(212, 237, 218, 0.8);
            color: #155724; 
            border-color: rgba(195, 230, 203, 0.6);
        }
        .feedback.incorrect { 
            background: rgba(248, 215, 218, 0.8);
            color: #721c24; 
            border-color: rgba(245, 198, 203, 0.6);
        }
        .gesture-status { 
            font-family: 'Paperozi', 'Noto Sans KR', sans-serif;
            background: rgba(227, 242, 253, 0.8);
            color: #1565c0; 
            border: 1px solid rgba(187, 222, 251, 0.6);
            padding: 15px; 
            border-radius: 15px; 
            margin: 15px 0; 
            text-align: center; 
            font-style: italic;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            font-weight: 300;
        }
        .sign-example { 
            margin-top: 25px; 
            text-align: center; 
        }
        .completion-section { 
            background: rgba(232, 245, 232, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(76, 175, 80, 0.2);
            border-radius: 20px; 
            padding: 35px; 
            margin: 25px 0; 
            text-align: center;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
        }
        .completion-section h3 { 
            font-family: 'Paperozi', 'Noto Sans KR', sans-serif;
            color: #2e7d32; 
            margin-bottom: 25px; 
            font-size: 2em;
            font-weight: 700;
        }
        .completion-buttons { 
            display: flex; 
            gap: 20px; 
            justify-content: center; 
            margin-top: 25px; 
        }
        .completion-btn { 
            font-family: 'Paperozi', 'Noto Sans KR', sans-serif;
            padding: 15px 30px; 
            border: none; 
            border-radius: 15px; 
            font-size: 1.2em; 
            font-weight: 300; 
            cursor: pointer; 
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 15px 0 rgba(31, 38, 135, 0.2);
        }
        .review-btn { 
            background: rgba(33, 150, 243, 0.8);
            color: white; 
        }
        .review-btn:hover { 
            background: rgba(25, 118, 210, 0.9);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px 0 rgba(33, 150, 243, 0.4);
        }
        .home-btn { 
            background: rgba(255, 152, 0, 0.8);
            color: white; 
        }
        .home-btn:hover { 
            background: rgba(245, 124, 0, 0.9);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px 0 rgba(255, 152, 0, 0.4);
        }
        .sign-example h5 { 
            font-family: 'Paperozi', 'Noto Sans KR', sans-serif;
            color: #2c3e50; 
            margin-bottom: 20px; 
            font-size: 1.4em;
            font-weight: 500;
        }
        .sign-image { 
            width: 220px; 
            height: 220px; 
            margin: 0 auto; 
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 1.6em; 
            color: rgba(44, 62, 80, 0.6);
            position: relative; 
            overflow: hidden;
            box-shadow: 0 8px 25px 0 rgba(31, 38, 135, 0.1);
            transition: all 0.3s ease;
        }
        .sign-image:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 35px 0 rgba(31, 38, 135, 0.3);
        }
        .sign-image img { 
            width: 100%; 
            height: 100%; 
            object-fit: contain; 
            border-radius: 20px;
        }
        .hidden { display: none; }
        .fade-in { animation: fadeIn 0.6s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        /* ë°°ê²½ ìˆ˜í™” ì´ë¯¸ì§€ ì• ë‹ˆë©”ì´ì…˜ */
        .background-signs {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }
        
        .background-sign {
            position: absolute;
            width: 80px;
            height: 80px;
            opacity: 0;
            transition: opacity 2s ease-in-out;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .background-sign img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            border-radius: 15px;
        }
        
        .background-sign.fade-in {
            opacity: 1.0;
        }
        
        .background-sign.fade-out {
            opacity: 0;
        }
        
        @media (max-width: 768px) {
            .main-content { grid-template-columns: 1fr; }
            .header h1 { font-size: 2em; }
            .background-sign {
                width: 60px;
                height: 60px;
            }
        }
    </style>
</head>
<body>
    <!-- ë°°ê²½ ìˆ˜í™” ì´ë¯¸ì§€ ì»¨í…Œì´ë„ˆ -->
    <div id="backgroundSigns" class="background-signs"></div>
    
    <div class="container">
        <div class="header">
            <h1> í•œê¸€ ìˆ˜í™” í•™ìŠµ</h1>
            <p>ì†ê°€ë½ìœ¼ë¡œ ë‚˜ì˜ ì´ë¦„ì„ ë°°ì›Œë³´ì„¸ìš”!</p>
        </div>

        <div class="main-content">
            <div class="left-panel">
                <h3>ì‹¤ì‹œê°„ ìˆ˜í™” ì¸ì‹</h3>
                <div class="video-container">
                    <video id="video" autoplay muted playsinline></video>
                    <canvas id="canvas"></canvas>
                </div>
                <div class="controls">
                    <button id="startBtn">ì¹´ë©”ë¼ ì‹œì‘</button>
                    <button id="stopBtn" disabled>ì¹´ë©”ë¼ ì¤‘ì§€</button>
                    <button id="practiceBtn" disabled>ì—°ìŠµ ëª¨ë“œ</button>
                </div>
                <div class="feedback-section">
                    <div id="feedback" class="feedback hidden"></div>
                    <div id="gestureStatus" class="gesture-status hidden"><p>ì†ì„ ì¹´ë©”ë¼ ì•ì— ì˜¬ë ¤ì£¼ì„¸ìš”</p></div>
                </div>
                <div class="current-letter">
                    <h2 id="currentLetterDisplay">-</h2>
                    <p id="currentLetterName">í•™ìŠµí•  ìëª¨ìŒì„ ì„ íƒí•˜ì„¸ìš”</p>
                </div>
            </div>

            <div class="right-panel">
                <div class="input-section">
                    <h3>ì´ë¦„ ì…ë ¥</h3>
                    <input type="text" id="nameInput" class="name-input" placeholder="ì˜ˆ:ê¹€ì² ìˆ˜" maxlength="10">
                    <button id="analyzeBtn" disabled>ì´ë¦„ ë¶„ì„í•˜ê¸°</button>
                </div>

                <div class="hand-option-section">
                    <h3>í•™ìŠµí•  ì† ì„ íƒ</h3>
                    <label><input type="radio" name="hand" value="right" checked> ì˜¤ë¥¸ì†</label>
                    <label><input type="radio" name="hand" value="left"> ì™¼ì†</label>
                </div>

                <div id="decomposedSection" class="hidden">
                    <h3>ìëª¨ìŒ ë¶„í•´</h3>
                    <div id="decomposedLetters" class="decomposed-letters"></div>
                </div>

                <div class="learning-section">
                    <h3>í•™ìŠµ ì§„í–‰</h3>
                    <div class="sign-guide">
                        <h4> í˜„ì¬ ìëª¨ìŒ ìˆ˜í™” ë°©ë²•</h4>
                        <div id="signInstructions">ì´ë¦„ì„ ì…ë ¥í•˜ê³  ë¶„ì„í•˜ê¸° ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</div>
                        <div id="signExample" class="sign-example hidden">
                            <h5>ìˆ˜í™” ì˜ˆì‹œ</h5>
                            <div id="signImage" class="sign-image">
                                <!-- ìˆ˜í™” ì´ë¯¸ì§€ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                                <!-- ì´ë¯¸ì§€ ê²½ë¡œ: images/signs/[ìëª¨ìŒ].png -->
                                <img id="signImageSrc" src="" alt="ìˆ˜í™” ì´ë¯¸ì§€" style="display: none;">
                                <div id="signImagePlaceholder" style="display: flex; align-items: center; justify-content: center; height: 100%; color: #888; font-size: 1.2em;">
                                    ì´ë¯¸ì§€ ì¤€ë¹„ ì¤‘...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- í•™ìŠµ ì™„ë£Œ ì„¹ì…˜ -->
                <div id="completionSection" class="completion-section hidden">
                    <h3>ğŸ‰ í•™ìŠµ ì™„ë£Œ!</h3>
                    <p><strong id="completedName"></strong>ë‹˜ì˜ ì´ë¦„ì„ ëª¨ë‘ í•™ìŠµí•˜ì…¨ìŠµë‹ˆë‹¤!</p>
                    <div class="completion-buttons">
                        <button id="reviewBtn" class="completion-btn review-btn">ë³µìŠµí•˜ê¸°</button>
                        <button id="homeBtn" class="completion-btn home-btn">ì²˜ìŒìœ¼ë¡œ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
<script>
    class KoreanSignLanguageLearner {
        constructor() {
           
            this.video = document.getElementById('video');
            this.canvas = document.getElementById('canvas');
            this.ctx = this.canvas.getContext('2d');
            this.startBtn = document.getElementById('startBtn');
            this.stopBtn = document.getElementById('stopBtn');
            this.practiceBtn = document.getElementById('practiceBtn');
            this.nameInput = document.getElementById('nameInput');
            this.analyzeBtn = document.getElementById('analyzeBtn');
            this.handOptionRadios = document.querySelectorAll('input[name="hand"]');

            this.hands = null;
            this.camera = null;
            this.isRunning = false;
            this.isPracticing = false;
            
            this.decomposedSyllables = [];
            this.currentSyllableIndex = 0;
            this.currentJamoTypeIndex = 0; 
            this.learnedLetters = new Set();
            this.practiceCount = 0;
            this.correctCount = 0;
            this.dominantHand = 'right';
            this.lastGestureTime = 0;
            this.gestureDebounceTime = 1000;
            this.isProcessingCorrect = false; // ì •ë‹µ ì²˜ë¦¬ ì¤‘ì¸ì§€ í™•ì¸í•˜ëŠ” í”Œë˜ê·¸
            
            // ë°°ê²½ ì• ë‹ˆë©”ì´ì…˜ ê´€ë ¨ ë³€ìˆ˜
            this.backgroundSignsContainer = document.getElementById('backgroundSigns');
            this.backgroundAnimationInterval = null;
            this.backgroundSigns = [];
            this.availableSigns = ['ã„±', 'ã„´', 'ã„·', 'ã„¹', 'ã…', 'ã…‚', 'ã……', 'ã…‡', 'ã…ˆ', 'ã…Š', 'ã…‹', 'ã…Œ', 'ã…', 'ã…', 'ã…', 'ã…', 'ã…‘', 'ã…“', 'ã…”', 'ã…•', 'ã…–', 'ã…—', 'ã…š', 'ã…›', 'ã…œ', 'ã…Ÿ', 'ã… ', 'ã…¡', 'ã…¢', 'ã…£'];
            
            this.signPatterns = this.initializeSignPatterns();
            
            this.initializeMediaPipe();
            this.setupEventListeners();
        }

        initializeSignPatterns() {
            /**
             * ê° ìëª¨ìŒë³„ ìˆ˜í™” íŒ¨í„´ ì •ì˜
             * 
             * ê° íŒ¨í„´ì€ ë‹¤ìŒ ìš”ì†Œë“¤ì„ í¬í•¨í•©ë‹ˆë‹¤:
             * - finger states: ê° ì†ê°€ë½ì˜ ìƒíƒœ (extended: í´ì§, bent: êµ¬ë¶€ëŸ¬ì§)
             * - palmDirection: ì†ë°”ë‹¥ ë°©í–¥ ìš”êµ¬ì‚¬í•­
             *   - 'forward': ì†ë°”ë‹¥ì´ ì¹´ë©”ë¼ë¥¼ í–¥í•¨ (ì •ë©´)
             *   - 'backward': ì†ë“±ì´ ì¹´ë©”ë¼ë¥¼ í–¥í•¨ (í›„ë©´)
             *   - 'side': ì†ì˜ ì˜†ë©´ì´ ì¹´ë©”ë¼ë¥¼ í–¥í•¨ (ì¸¡ë©´)
             *   - 'up': ì†ë°”ë‹¥ì´ ìœ„ë¥¼ í–¥í•¨
             *   - 'down': ì†ë°”ë‹¥ì´ ì•„ë˜ë¥¼ í–¥í•¨
             *   - 'any': ë°©í–¥ ì œí•œ ì—†ìŒ
             * - relativePosition: ì†ê°€ë½ë“¤ì˜ ìƒëŒ€ì  ìœ„ì¹˜ ê´€ê³„
             *   - 'straight': ì†ê°€ë½ë“¤ì´ ì¼ì§ì„ ìƒì— ë°°ì¹˜
             *   - 'spread': ì†ê°€ë½ë“¤ì´ ë²Œì–´ì ¸ ìˆìŒ
             *   - 'closed': ì†ê°€ë½ë“¤ì´ ëª¨ì—¬ìˆìŒ
             *   - 'specific': íŠ¹ì • íŒ¨í„´ (ìƒì„¸ ì„¤ëª… í•„ìš”)
             * - description: ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì¤„ ì„¤ëª…
             * 
             * ë°©í–¥ íŒë³„ ì‘ë™ ë°©ì‹:
             * 1. calculatePalmNormal() í•¨ìˆ˜ë¡œ ì†ë°”ë‹¥ì˜ ë²•ì„ ë²¡í„° ê³„ì‚°
             * 2. ë²•ì„ ë²¡í„°ì˜ x, y, z ì„±ë¶„ìœ¼ë¡œ ë°©í–¥ íŒë³„
             * 3. ì†ê°€ë½ ìƒëŒ€ ìœ„ì¹˜ëŠ” landmarks ê°„ ê±°ë¦¬ì™€ ê°ë„ë¡œ ë¶„ì„
             */
            return {
                'ã„±': { 
                    thumb: 'extended', 
                    index: 'bent', 
                    middle: 'extended', 
                    ring: 'extended', 
                    pinky: 'extended', 
                    palmDirection: 'backward',  
                    relativePosition: 'specific',  // ê²€ì§€ì™€ ì—„ì§€ë§Œ í´ê³  ë‚˜ë¨¸ì§€ëŠ” êµ¬ë¶€ë¦¼
                    description: 'ê²€ì§€ì™€ ì—„ì§€ë¥¼ í´ê³  ê²€ì§€ë¡œ ì•„ë˜ë¥¼ ê°€ë¦¬í‚µë‹ˆë‹¤.' 
                },
                'ã„´': { 
                    thumb: 'extended', 
                    index: 'extended', 
                    middle: 'extended', 
                    ring: 'extended', 
                    pinky: 'extended', 
                    palmDirection: 'backward',  
                    relativePosition: 'specific',  
                    description: 'ê²€ì§€ì™€ ì—„ì§€ë¥¼ í´ê³  ì˜†ì„ ê°€ë¦¬í‚µë‹ˆë‹¤.' 
                },
                'ã„·': { 
                    thumb: 'bent', 
                    index: 'extended', 
                    middle: 'extended', 
                    ring: 'extended', 
                    pinky: 'extended', 
                    palmDirection: 'backward',  
                    relativePosition: 'spread', 
                    description: 'ê²€ì§€, ì¤‘ì§€ë¥¼ í´ê³  ì†ë“±ì´ ë³´ì´ê²Œ ì˜†ì„ ê°€ë¦¬í‚µë‹ˆë‹¤' 
                },
                'ã„¹': { 
                    thumb: 'bent', 
                    index: 'extended', 
                    middle: 'extended', 
                    ring: 'extended', 
                    pinky: 'extended', 
                    palmDirection: 'backward', 
                    relativePosition: 'spread',  
                    description: 'ê²€ì§€ì™€ ì¤‘ì§€, ì•½ì§€ë¥¼ í´ê³  ì†ë“±ì´ ë³´ì´ê²Œ ì˜†ì„ ê°€ë¦¬í‚µë‹ˆë‹¤.' 
                },
                'ã…': { 
                    thumb: 'bent', 
                    index: 'extended', 
                    middle: 'extended', 
                    ring: 'bent', 
                    pinky: 'bent', 
                    palmDirection: 'forward',  // ì†ë°”ë‹¥ì´ ì¹´ë©”ë¼ë¥¼ í–¥í•´ì•¼ í•¨
                    relativePosition: 'closed', 
                    description: 'ì—„ì§€ë¥¼ êµ¬ë¶€ë¦¬ê³  ë‚˜ë¨¸ì§€ ì†ê°€ë½ë“¤ì„ í¼ì¹©ë‹ˆë‹¤.' 
                },
                'ã…‚': { 
                    thumb: 'bent', 
                    index: 'extended', 
                    middle: 'extended', 
                    ring: 'extended', 
                    pinky: 'extended', 
                    palmDirection: 'forward',  // ì†ë°”ë‹¥ì´ ì¹´ë©”ë¼ë¥¼ í–¥í•´ì•¼ í•¨
                    relativePosition: 'spread',  // ëª¨ë“  ì†ê°€ë½ì´ í¼ì³ì§
                    description: 'ì†ë°”ë‹¥ì´ ì•ì„ í–¥í•˜ê²Œ í•˜ê³  ì—„ì§€ë¥¼ ì œì™¸í•œ ì†ê°€ë½ì„ í¼ì¹©ë‹ˆë‹¤.' 
                },
                'ã……': { 
                    thumb: 'bent', 
                    index: 'bent', 
                    middle: 'bent', 
                    ring: 'extended', 
                    pinky: 'extended', 
                    palmDirection: 'backward',  
                    relativePosition: 'spread',  // ê²€ì§€ì™€ ì¤‘ì§€ë§Œ í´ê³  ë‚˜ë¨¸ì§€ëŠ” êµ¬ë¶€ë¦¼
                    description: 'ê²€ì§€ì™€ ì¤‘ì§€ë§Œ í´ê³  ì†ë“±ì´ ë³´ì´ê²Œ ì•„ë˜ìª½ì„ ê°€ë¦¬í‚µë‹ˆë‹¤.' 
                },
                'ã…‡': { 
                    thumb: 'extended', 
                    index: 'extended', 
                    middle: 'extended', 
                    ring: 'extended', 
                    pinky: 'extended', 
                    palmDirection: 'side', 
                    relativePosition: 'specific',  // ì—„ì§€ì™€ ê²€ì§€ ëì´ ë§Œë‚˜ ë™ê·¸ë¼ë¯¸ í˜•ì„±
                    description: 'ì—„ì§€ì™€ ê²€ì§€ ëì„ ë¶™ì—¬ ë™ê·¸ë¼ë¯¸ë¥¼ ë§Œë“­ë‹ˆë‹¤. OKì‚¬ì¸ì²˜ëŸ¼!' 
                },
                'ã…ˆ': { 
                    thumb: 'extended', 
                    index: 'bent', 
                    middle: 'bent', 
                    ring: 'extended', 
                    pinky: 'extended', 
                    palmDirection: 'backward',  
                    relativePosition: 'spread',  
                    description: 'ê²€ì§€, ì¤‘ì§€, ì—„ì§€ë¥¼ ì«™ í´ê³  ì†ë“±ì´ ë³´ì´ê²Œ ì•„ë˜ë¥¼ ê°€ë¦¬í‚µë‹ˆë‹¤.' 
                },
                'ã…Š': { 
                    thumb: 'extended', 
                    index: 'bent', 
                    middle: 'bent', 
                    ring: 'bent', 
                    pinky: 'extended', 
                    palmDirection: 'backward',  // ì†ë°”ë‹¥ì´ ì¹´ë©”ë¼ë¥¼ í–¥í•´ì•¼ í•¨
                    relativePosition: 'spread',  
                    description: 'ê²€ì§€,ì¤‘ì§€,ì—„ì§€,ì•½ì§€ ì†ê°€ë½ì„ ì«™ í´ê³  ì†ë“±ì´ ë³´ì´ê²Œ ì•„ë˜ë¥¼ ê°€ë¦¬í‚µë‹ˆë‹¤.' 
                },
                'ã…‹': { 
                    thumb: 'extended', 
                    index: 'extended', 
                    middle: 'bent', 
                    ring: 'extended', 
                    pinky: 'extended', 
                    palmDirection: 'backward',  
                    relativePosition: 'specific', 
                    description: 'ì—„ì§€ì™€ ì¤‘ì§€ë¥¼ í´ê³  ì†ë“±ì´ ë³´ì´ê²Œ ì•„ë˜ë¥¼ ê°€ë¦¬í‚µë‹ˆë‹¤.' 
                },
                'ã…Œ': { 
                    thumb: 'bent', 
                    index: 'extended', 
                    middle: 'extended', 
                    ring: 'extended', 
                    pinky: 'extended', 
                    palmDirection: 'backward',  
                    relativePosition: 'specific', 
                    description: 'ê²€ì§€, ì¤‘ì§€, ì•½ì§€ë¥¼ í´ê³  ì¤‘ì§€ì™€ ì•½ì§€ëŠ” ë¶™ì¸ ë’¤ ì†ë“±ì´ ë³´ì´ê²Œ ì˜†ì„ ê°€ë¦¬í‚µë‹ˆë‹¤.' 
                },
                'ã…': { 
                    thumb: 'extended', 
                    index: 'extended', 
                    middle: 'extended', 
                    ring: 'extended', 
                    pinky: 'extended', 
                    palmDirection: 'forward',  // ì†ë°”ë‹¥ì´ ì¹´ë©”ë¼ë¥¼ í–¥í•´ì•¼ í•¨
                    relativePosition: 'specific',  
                    description: 'ëª¨ë“  ì†ê°€ë½ì„ ë°˜ë§Œ ì ‘ê³  ì†ë°”ë‹¥ì´ ì•ì„ í–¥í•˜ê²Œ í•©ë‹ˆë‹¤.' 
                },
                'ã…': { 
                    thumb: 'extended', 
                    index: 'extended', 
                    middle: 'extended', 
                    ring: 'extended', 
                    pinky: 'extended', 
                    palmDirection: 'any',  
                    relativePosition: 'specific',  
                    description: 'ì—„ì§€ë§Œ í´ê³  ì—„ì§€ê°€ ìœ„ë¥¼ í–¥í•˜ê³ , ì†ë“±ì€ ì˜†ì„ ë³´ê²Œ í•©ë‹ˆë‹¤ (ì—„ì§€ì²™ ìì„¸)).' 
                },
                'ã…': { 
                    thumb: 'bent', 
                    index: 'extended', 
                    middle: 'bent', 
                    ring: 'bent', 
                    pinky: 'bent', 
                    palmDirection: 'forward', 
                    relativePosition: 'specific',  
                    description: 'ê²€ì§€ë§Œ í´ê³  ì†ë°”ë‹¥ì´ ì•ì„ í–¥í•˜ê²Œ ì²œì¥ì„ ê°€ë¦¬í‚µë‹ˆë‹¤.' 
                },
                'ã…‘': { 
                    thumb: 'bent', 
                    index: 'extended', 
                    middle: 'extended', 
                    ring: 'bent', 
                    pinky: 'bent', 
                    palmDirection: 'forward',  
                    relativePosition: 'closed',  
                    description: 'ê²€ì§€ì™€ ì¤‘ì§€ë¥¼ í´ê³  ì†ë°”ë‹¥ì´ ì•ì„ í–¥í•˜ê²Œ ì²œì¥ì„ ê°€ë¦¬í‚µë‹ˆë‹¤.' 
                },
                'ã…“': { 
                    thumb: 'extended', 
                    index: 'extended', 
                    middle: 'extended', 
                    ring: 'extended', 
                    pinky: 'extended', 
                    palmDirection: 'side',  // ì†ì˜ ì˜†ë©´ì´ ì¹´ë©”ë¼ë¥¼ í–¥í•´ì•¼ í•¨
                    relativePosition: 'specific',  // ê²€ì§€ë§Œ í´ê³  ì˜†ì„ ê°€ë¦¬í‚´
                    description: 'ê²€ì§€ë¥¼ í´ê³ , ì†ë“±ì´ ì˜†ì„ í–¥í•œ ì±„ë¡œ ì•ì„ ê°€ë¦¬í‚µë‹ˆë‹¤.' 
                },
                'ã…•': { 
                    thumb: 'extended', 
                    index: 'extended', 
                    middle: 'extended', 
                    ring: 'extended', 
                    pinky: 'extended', 
                    palmDirection: 'side',  // ì†ì˜ ì˜†ë©´ì´ ì¹´ë©”ë¼ë¥¼ í–¥í•´ì•¼ í•¨
                    relativePosition: '',  
                    description: 'ê²€ì§€ì™€ ì¤‘ì§€ë¥¼ í´ê³  ì†ë“±ì´ ì˜†ì„ í–¥í•œ ì±„ë¡œ ì•ì„ ê°€ë¦¬í‚µë‹ˆë‹¤.' 
                },
                'ã…—': { 
                    thumb: 'bent', 
                    index: 'extended', 
                    middle: 'bent', 
                    ring: 'bent', 
                    pinky: 'bent', 
                    palmDirection: 'backward',  
                    relativePosition: 'specific',  // ê²€ì§€ë§Œ í´ê³  ë‚˜ë¨¸ì§€ëŠ” êµ¬ë¶€ë¦¼
                    description: 'ê²€ì§€ë¥¼ í´ê³  ì†ë“±ì´ ë³´ì´ê²Œ ì²œì¥ì„ ê°€ë¦¬í‚µë‹ˆë‹¤.' 
                },
                'ã…›': { 
                    thumb: 'bent', 
                    index: 'extended', 
                    middle: 'extended', 
                    ring: 'bent', 
                    pinky: 'bent', 
                    palmDirection: 'backward',  // ì†ë°”ë‹¥ì´ ì¹´ë©”ë¼ë¥¼ í–¥í•´ì•¼ í•¨
                     relativePosition: 'closed',  // ê²€ì§€ì™€ ì¤‘ì§€ë§Œ í´ê³  ë‚˜ë¨¸ì§€ëŠ” êµ¬ë¶€ë¦¼
                    description: 'ê²€ì§€ì™€ ì¤‘ì§€ë¥¼ í´ê³  ì†ë“±ì´ ë³´ì´ê²Œ ì²œì¥ì„ ê°€ë¦¬í‚µë‹ˆë‹¤.' 
                },
                'ã…œ': { 
                    thumb: 'bent', 
                    index: 'bent', 
                    middle: 'extended', 
                    ring: 'extended', 
                    pinky: 'extended', 
                    palmDirection: 'backward',  
                    relativePosition: 'specific',  // ê²€ì§€ë§Œ í´ê³  ì•„ë˜ë¥¼ ê°€ë¦¬í‚´
                    description: 'ê²€ì§€ë¥¼ í´ê³  ì†ë“±ì´ ë³´ì´ê²Œ ì•„ë˜ë¥¼ ê°€ë¦¬í‚µë‹ˆë‹¤.' 
                },
                'ã… ': { 
                    thumb: 'bent', 
                    index: 'bent', 
                    middle: 'bent', 
                    ring: 'extended', 
                    pinky: 'extended', 
                    palmDirection: 'backward',  
                    relativePosition: 'colsed',  // ê²€ì§€ì™€ ì¤‘ì§€ë¥¼ í´ê³  ì•„ë˜ë¥¼ ê°€ë¦¬í‚´
                    description: 'ê²€ì§€ì™€ ì¤‘ì§€ë¥¼ ë¶™ì¸ ìƒíƒœë¡œ í´ê³  ì†ë“±ì´ ë³´ì´ê²Œ ì•„ë˜ë¥¼ ê°€ë¦¬í‚µë‹ˆë‹¤.' 
                },
                'ã…¡': { 
                    thumb: 'bent', 
                    index: 'extended', 
                    middle: 'extended', 
                    ring: 'extended', 
                    pinky: 'extended', 
                    palmDirection: 'backward',  
                    relativePosition: 'specific',  // ê²€ì§€ë§Œ í´ê³  ì˜†ì„ ê°€ë¦¬í‚´
                    description: 'ê²€ì§€ë¥¼ í´ê³  ì•„ë˜ë¥¼ ê°€ë¦¬í‚µë‹ˆë‹¤.' 
                },
                'ã…£': { 
                    thumb: 'bent', 
                    index: 'bent', 
                    middle: 'bent', 
                    ring: 'bent', 
                    pinky: 'extended', 
                    palmDirection: 'forward',  // ì†ë°”ë‹¥ì´ ì¹´ë©”ë¼ë¥¼ í–¥í•´ì•¼ í•¨
                    relativePosition: 'specific',  // ìƒˆë¼ì†ê°€ë½ë§Œ í´ê³  ë‚˜ë¨¸ì§€ëŠ” êµ¬ë¶€ë¦¼
                    description: 'ìƒˆë¼ì†ê°€ë½ë§Œ í´ê³  ì†ë°”ë‹¥ì´ ë³´ì´ê²Œ ì²œì¥ì„ ê°€ë¦¬í‚µë‹ˆë‹¤.' 
                },
                
                'ã…': {
                    thumb: 'bent',
                    index: 'extended',
                    middle: 'bent',
                    ring: 'bent',
                    pinky: 'extended',
                    palmDirection: 'forward',
                    relativePosition: 'specific',
                    description: ' ê²€ì§€ì™€ ìƒˆë¼ì†ê°€ë½ì„ í´ê³  ì²œì¥ì„ ê°€ë¦¬í‚µë‹ˆë‹¤.'
                },
                'ã…”': {
                    thumb: 'bent',
                    index: 'extended',
                    middle: 'extended',
                    ring: 'extended',
                    pinky: 'extended',
                    palmDirection: 'side',
                    relativePosition: 'specific',
                    description: 'ê²€ì§€ì™€ ìƒˆë¼ì†ê°€ë½ì„ í´ê³  ì•ì„ ê°€ë¦¬í‚µë‹ˆë‹¤'
                },
                'ã…–': {
                    thumb: 'bent',
                    index: 'extended',
                    middle: 'extended',
                    ring: 'extended',
                    pinky: 'extended',
                    palmDirection: 'side',
                    relativePosition: 'specific',
                    description: 'ê²€ì§€ì™€ ì¤‘ì§€, ìƒˆë¼ì†ê°€ë½ì„ í´ê³  ì•ì„ ê°€ë¦¬í‚µë‹ˆë‹¤'
                },
                'ã…¢': {
                    thumb: 'bent',
                    index: 'extended',
                    middle: 'bent',
                    ring: 'bent',
                    pinky: 'extended',
                    palmDirection: 'backward',
                    relativePosition: 'specific',
                    description: 'ê²€ì§€ì™€ ìƒˆë¼ì†ê°€ë½ì„ í´ê³  ì†ë“±ì´ ì•ìœ¼ë¡œ í–¥í•˜ê²Œ ì˜†ì„ ê°€ë¦¬í‚µë‹ˆë‹¤ '
                },
                'ã…š': {
                    thumb: 'bent',
                    index: 'extended',
                    middle: 'bent',
                    ring: 'bent',
                    pinky: 'extended',
                    palmDirection: 'backward',
                    relativePosition: 'specific',
                    description: 'ê²€ì§€ì™€ ìƒˆë¼ì†ê°€ë½ì„ í´ê³  ì†ë“±ì´ ì•ìœ¼ë¡œ í–¥í•˜ê²Œ ì²œì¥ì„ ê°€ë¦¬í‚µë‹ˆë‹¤ '
                },
                'ã…Ÿ': {
                    thumb: 'extended',
                    index: 'bent',
                    middle: 'extended',
                    ring: 'extended',
                    pinky: 'bent',
                    palmDirection: 'backward',
                    relativePosition: 'specific',
                    description: 'ê²€ì§€ì™€ ìƒˆë¼ì†ê°€ë½ì„ í´ê³  ì†ë“±ì´ ì•ìœ¼ë¡œ í–¥í•˜ê²Œ ì•„ë˜ë¥¼ ê°€ë¦¬í‚µë‹ˆë‹¤ '
                },
            };
        }


       
        async initializeMediaPipe() { this.hands = new Hands({ locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}` }); this.hands.setOptions({ maxNumHands: 1, modelComplexity: 1, minDetectionConfidence: 0.7, minTrackingConfidence: 0.7 }); this.hands.onResults((results) => this.onResults(results)); }
        setupEventListeners() { this.startBtn.addEventListener('click', () => this.startCamera()); this.stopBtn.addEventListener('click', () => this.stopCamera()); this.practiceBtn.addEventListener('click', () => this.togglePracticeMode()); this.nameInput.addEventListener('input', () => this.onNameInputChange()); this.analyzeBtn.addEventListener('click', () => this.analyzeName()); this.handOptionRadios.forEach(radio => { radio.addEventListener('change', (event) => { this.dominantHand = event.target.value; }); }); }
        onNameInputChange() { this.analyzeBtn.disabled = !this.nameInput.value.trim(); }
        analyzeName() { 
            const name = this.nameInput.value.trim(); 
            if (!name) return; 
            
            this.decomposedSyllables = this.decomposeKoreanName(name); 
            this.currentSyllableIndex = 0; 
            this.currentJamoTypeIndex = 0; 
            this.learnedLetters.clear(); 
            this.practiceCount = 0; 
            this.correctCount = 0; 
            this.displayDecomposedLetters(); 
            this.updateCurrentLetter(); 
            document.getElementById('decomposedSection').classList.remove('hidden'); 
            this.practiceBtn.disabled = !this.isRunning;
            
            // í•™ìŠµ ì‹œì‘ í›„ ë ˆì´ì•„ì›ƒ ë³€ê²½
            this.changeLayoutForLearning();
        }
        decomposeKoreanName(name) { const syllables = []; const initials = ['ã„±', 'ã„²', 'ã„´', 'ã„·', 'ã„¸', 'ã„¹', 'ã…', 'ã…‚', 'ã…ƒ', 'ã……', 'ã…†', 'ã…‡', 'ã…ˆ', 'ã…‰', 'ã…Š', 'ã…‹', 'ã…Œ', 'ã…', 'ã…']; const medials = ['ã…', 'ã…', 'ã…‘', 'ã…’', 'ã…“', 'ã…”', 'ã…•', 'ã…–', 'ã…—', 'ã…˜', 'ã…™', 'ã…š', 'ã…›', 'ã…œ', 'ã…', 'ã…', 'ã…Ÿ', 'ã… ', 'ã…¡', 'ã…¢', 'ã…£']; const finals = ['', 'ã„±', 'ã„²', 'ã„³', 'ã„´', 'ã„µ', 'ã„¶', 'ã„·', 'ã„¹', 'ã„º', 'ã„»', 'ã„¼', 'ã„½', 'ã„¾', 'ã„¿', 'ã…€', 'ã…', 'ã…‚', 'ã…„', 'ã……', 'ã…†', 'ã…‡', 'ã…ˆ', 'ã…Š', 'ã…‹', 'ã…Œ', 'ã…', 'ã…']; for (let i = 0; i < name.length; i++) { const code = name[i].charCodeAt(0); if (code >= 0xAC00 && code <= 0xD7A3) { const base = code - 0xAC00; const initial = Math.floor(base / 588); const medial = Math.floor((base % 588) / 28); const final = base % 28; const syllableJamos = [initials[initial], medials[medial]]; if (finals[final]) syllableJamos.push(finals[final]); syllables.push({ char: name[i], jamos: syllableJamos, decomposed: `${initials[initial]}${medials[medial]}${finals[final]}` }); } } return syllables; }
        displayDecomposedLetters() { const container = document.getElementById('decomposedLetters'); container.innerHTML = ''; this.decomposedSyllables.forEach((syllable, index) => { const card = document.createElement('div'); card.className = 'letter-card'; card.id = `syllable-${index}`; card.innerHTML = `<h4>${syllable.char}</h4><p>${syllable.decomposed}</p>`; container.appendChild(card); }); }
        updateCurrentLetter() { if (this.currentSyllableIndex >= this.decomposedSyllables.length) { document.getElementById('currentLetterDisplay').textContent = 'ì™„ë£Œ!'; document.getElementById('currentLetterName').textContent = 'ëª¨ë“  ìëª¨ìŒì„ í•™ìŠµí–ˆìŠµë‹ˆë‹¤!'; document.getElementById('signInstructions').textContent = 'ì¶•í•˜í•©ë‹ˆë‹¤! ì´ë¦„ì„ ëª¨ë‘ ì™„ì„±í–ˆì–´ìš”.'; this.hideSignExample(); return; } const currentSyllable = this.decomposedSyllables[this.currentSyllableIndex]; const currentJamo = currentSyllable.jamos[this.currentJamoTypeIndex]; const jamoTypes = ['ì´ˆì„±', 'ì¤‘ì„±', 'ì¢…ì„±']; document.getElementById('currentLetterDisplay').textContent = currentJamo; document.getElementById('currentLetterName').textContent = `${jamoTypes[this.currentJamoTypeIndex]}: ${currentJamo}`; this.updateSignInstructions(currentJamo); document.querySelectorAll('.letter-card').forEach(card => card.classList.remove('current')); document.getElementById(`syllable-${this.currentSyllableIndex}`).classList.add('current'); }
        updateSignInstructions(letter) { const pattern = this.signPatterns[letter]; if (pattern) { document.getElementById('signInstructions').innerHTML = `<ul><li>${pattern.description}</li></ul>`; this.showSignExample(letter); } else { document.getElementById('signInstructions').innerHTML = 'ì´ ìëª¨ìŒì˜ ìˆ˜í™” íŒ¨í„´ì´ ì—†ìŠµë‹ˆë‹¤. ë‹¤ìŒìœ¼ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.'; this.hideSignExample(); setTimeout(() => this.nextJamo(), 1500); } }
        showSignExample(letter) { 
            const signExample = document.getElementById('signExample'); 
            const signImageSrc = document.getElementById('signImageSrc');
            const signImagePlaceholder = document.getElementById('signImagePlaceholder');
            
            // ì´ë¯¸ì§€ ê²½ë¡œ ì„¤ì • (images/signs/[ìëª¨ìŒ].png)
            const imagePath = `images/signs/${letter}.png`;
            signImageSrc.src = imagePath;
            
            // ì´ë¯¸ì§€ ë¡œë“œ ì„±ê³µ ì‹œ
            signImageSrc.onload = () => {
                signImagePlaceholder.style.display = 'none';
                signImageSrc.style.display = 'block';
            };
            
            // ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨ ì‹œ (ì´ë¯¸ì§€ê°€ ì—†ëŠ” ê²½ìš°)
            signImageSrc.onerror = () => {
                signImagePlaceholder.style.display = 'flex';
                signImageSrc.style.display = 'none';
                signImagePlaceholder.textContent = 'ì´ë¯¸ì§€ ì¤€ë¹„ ì¤‘...';
            };
            
            signExample.classList.remove('hidden'); 
            signExample.classList.add('fade-in'); 
        }
        hideSignExample() { document.getElementById('signExample').classList.add('hidden'); }
        
        /**
         * í•™ìŠµ ì‹œì‘ í›„ ë ˆì´ì•„ì›ƒì„ ë³€ê²½í•˜ëŠ” í•¨ìˆ˜
         * ì´ë¦„ ì…ë ¥ê³¼ ì† ì„ íƒ ì„¹ì…˜ì„ ì•„ë˜ë¡œ, ìˆ˜í™” ë°©ë²• ì•ˆë‚´ë¥¼ ìœ„ë¡œ ì´ë™
         */
        changeLayoutForLearning() {
            const rightPanel = document.querySelector('.right-panel');
            rightPanel.classList.add('learning-started');
            
            // ë¶€ë“œëŸ¬ìš´ ì• ë‹ˆë©”ì´ì…˜ì„ ìœ„í•œ ì¶”ê°€ ìŠ¤íƒ€ì¼ë§
            setTimeout(() => {
                const inputSection = document.querySelector('.input-section');
                const handSection = document.querySelector('.hand-option-section');
                
                // ì…ë ¥ ì„¹ì…˜ ì¶•ì†Œ
                inputSection.style.fontSize = '0.9em';
                inputSection.style.opacity = '0.8';
                
                // ì† ì„ íƒ ì„¹ì…˜ ì¶•ì†Œ
                handSection.style.fontSize = '0.9em';
                handSection.style.opacity = '0.8';
            }, 100);
        }
        async startCamera() { try { this.startBtn.disabled = true; this.camera = new Camera(this.video, { onFrame: async () => { if (this.hands) await this.hands.send({ image: this.video }); }, width: 500, height: 400 }); await this.camera.start(); this.isRunning = true; this.stopBtn.disabled = false; if (this.decomposedSyllables.length > 0) this.practiceBtn.disabled = false; } catch (error) { console.error('ì¹´ë©”ë¼ ì‹œì‘ ì˜¤ë¥˜:', error); this.startBtn.disabled = false; } }
        stopCamera() { 
            if (this.camera) { this.camera.stop(); this.camera = null; } 
            this.isRunning = false; 
            this.isPracticing = false; 
            this.startBtn.disabled = false; 
            this.stopBtn.disabled = true; 
            this.practiceBtn.disabled = true; 
            this.practiceBtn.textContent = 'ì—°ìŠµ ëª¨ë“œ'; 
            this.practiceBtn.style.background = '#3498db'; 
            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height); 
            this.hideFeedback();
            
            // ì¹´ë©”ë¼ ì¤‘ì§€ ì‹œ ë°°ê²½ ì• ë‹ˆë©”ì´ì…˜ë„ ì¤‘ì§€
            this.stopBackgroundAnimation();
        }
        togglePracticeMode() { 
            this.isPracticing = !this.isPracticing; 
            this.practiceBtn.textContent = this.isPracticing ? 'ì—°ìŠµ ì¤‘ì§€' : 'ì—°ìŠµ ì‹œì‘'; 
            this.practiceBtn.style.background = this.isPracticing ? '#e74c3c' : '#2980b9'; 
            document.getElementById('gestureStatus').classList.toggle('hidden', !this.isPracticing); 
            
            // ì—°ìŠµ ëª¨ë“œ ì‹œì‘/ì¤‘ì§€ì— ë”°ë¼ ë°°ê²½ ì• ë‹ˆë©”ì´ì…˜ ì œì–´
            if (this.isPracticing) {
                this.startBackgroundAnimation();
            } else {
                this.stopBackgroundAnimation();
                this.hideFeedback();
            }
        }
        showFeedback(message, type) { const feedback = document.getElementById('feedback'); feedback.textContent = message; feedback.className = `feedback ${type} fade-in`; feedback.classList.remove('hidden'); }
        hideFeedback() { document.getElementById('feedback').classList.add('hidden'); }
        nextJamo() { 
            const currentSyllable = this.decomposedSyllables[this.currentSyllableIndex]; 
            if (this.currentJamoTypeIndex >= currentSyllable.jamos.length - 1) { 
                document.getElementById(`syllable-${this.currentSyllableIndex}`).classList.add('completed'); 
                this.currentSyllableIndex++; 
                this.currentJamoTypeIndex = 0; 
                
                // ëª¨ë“  ìëª¨ìŒ í•™ìŠµ ì™„ë£Œ í™•ì¸
                if (this.currentSyllableIndex >= this.decomposedSyllables.length) {
                    this.showCompletion();
                    return;
                }
            } else { 
                this.currentJamoTypeIndex++; 
            } 
            this.updateCurrentLetter(); 
            this.hideFeedback();
            
            // ìëª¨ìŒì´ ë³€ê²½ë˜ë©´ ë°°ê²½ ì´ë¯¸ì§€ë„ ì—…ë°ì´íŠ¸
            if (this.isPracticing) {
                this.updateBackgroundSigns();
            }
        }
        showCompletion() {
            // í•™ìŠµ ì™„ë£Œ ì„¹ì…˜ í‘œì‹œ
            document.getElementById('completionSection').classList.remove('hidden');
            document.getElementById('completedName').textContent = this.userName;
            
            // ì—°ìŠµ ëª¨ë“œ ì¤‘ì§€
            if (this.isPracticing) {
                this.togglePracticeMode();
            }
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            document.getElementById('reviewBtn').onclick = () => this.startReview();
            document.getElementById('homeBtn').onclick = () => this.goHome();
        }
        
        startReview() {
            // ë³µìŠµ ëª¨ë“œ ì‹œì‘ - ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘
            this.currentSyllableIndex = 0;
            this.currentJamoTypeIndex = 0;
            this.learnedLetters.clear();
            this.correctCount = 0;
            
            // ì™„ë£Œ ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            document.getElementById('completionSection').classList.add('hidden');
            
            // í˜„ì¬ ìëª¨ìŒ ì—…ë°ì´íŠ¸
            this.updateCurrentLetter();
            
            // ì—°ìŠµ ëª¨ë“œ ì‹œì‘
            if (!this.isPracticing) {
                this.togglePracticeMode();
            }
        }
        
        goHome() {
            // ì²˜ìŒ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸°
            this.stopCamera();
            
            // ëª¨ë“  ì„¹ì…˜ ì´ˆê¸°í™”
            document.getElementById('completionSection').classList.add('hidden');
            document.getElementById('decomposedSection').classList.add('hidden');
            document.getElementById('signExample').classList.add('hidden');
            
            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.getElementById('nameInput').value = '';
            document.getElementById('nameInput').disabled = false;
            document.getElementById('analyzeBtn').disabled = false;
            
            // ì† ì„ íƒ ì´ˆê¸°í™”
            const handOptions = document.querySelectorAll('input[name="handPreference"]');
            handOptions.forEach(option => option.checked = false);
            
            // ë ˆì´ì•„ì›ƒ ì´ˆê¸°í™”
            const rightPanel = document.querySelector('.right-panel');
            rightPanel.classList.remove('learning-started');
            
            // í•™ìŠµ ìƒíƒœ ì´ˆê¸°í™”
            this.userName = '';
            this.decomposedSyllables = [];
            this.currentSyllableIndex = 0;
            this.currentJamoTypeIndex = 0;
            this.learnedLetters.clear();
            this.correctCount = 0;
            this.practiceCount = 0;
            
            // ì•ˆë‚´ ë©”ì‹œì§€ ì´ˆê¸°í™”
            document.getElementById('signInstructions').textContent = 'ì´ë¦„ì„ ì…ë ¥í•˜ê³  ë¶„ì„í•˜ê¸° ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.';
        }
        
       
        calculatePalmNormal(landmarks) {
            const p0 = landmarks[0]; // Wrist
            const p5 = landmarks[5]; // Index finger MCP
            const p17 = landmarks[17]; // Pinky MCP

            // Create two vectors on the plane of the palm
            const v1 = { x: p5.x - p0.x, y: p5.y - p0.y, z: p5.z - p0.z };
            const v2 = { x: p17.x - p0.x, y: p17.y - p0.y, z: p17.z - p0.z };

            // Calculate the cross product to get the normal vector
            const normal = {
                x: v1.y * v2.z - v1.z * v2.y,
                y: v1.z * v2.x - v1.x * v2.z,
                z: v1.x * v2.y - v1.y * v2.x
            };

            // Normalize the vector (make its length 1)
            const magnitude = Math.sqrt(normal.x * normal.x + normal.y * normal.y + normal.z * normal.z);
            normal.x /= magnitude;
            normal.y /= magnitude;
            normal.z /= magnitude;

            return normal;
        }

        onResults(results) {
            this.canvas.width = this.video.videoWidth;
            this.canvas.height = this.video.videoHeight;
            this.ctx.save();
            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);

            if (results.multiHandLandmarks && results.multiHandLandmarks.length > 0) {
                const landmarks = results.multiHandLandmarks[0];
                drawConnectors(this.ctx, landmarks, HAND_CONNECTIONS, { color: '#00FF00', lineWidth: 5 });
                drawLandmarks(this.ctx, landmarks, { color: '#FF0000', lineWidth: 2 });
                
                if (this.isPracticing && this.decomposedSyllables.length > 0) {
                    const now = Date.now();
                    if (now - this.lastGestureTime > this.gestureDebounceTime) {
                        this.processGesture(landmarks);
                        this.lastGestureTime = now;
                    }
                }
                document.getElementById('gestureStatus').textContent = 'ì† ëª¨ì–‘ì„ ë§Œë“¤ì–´ì£¼ì„¸ìš”!';
            } else if(this.isPracticing) {
                document.getElementById('gestureStatus').textContent = 'ì¹´ë©”ë¼ì— ì†ì´ ë³´ì´ë„ë¡ í•´ì£¼ì„¸ìš”.';
            }
            this.ctx.restore();
        }
        
        processGesture(landmarks) {
            if (this.currentSyllableIndex >= this.decomposedSyllables.length) return;
            
            // ì •ë‹µ ì²˜ë¦¬ ì¤‘ì´ë©´ ìƒˆë¡œìš´ ì œìŠ¤ì²˜ ì¸ì‹í•˜ì§€ ì•ŠìŒ
            if (this.isProcessingCorrect) return;

            const currentJamo = this.decomposedSyllables[this.currentSyllableIndex].jamos[this.currentJamoTypeIndex];
            const targetPattern = this.signPatterns[currentJamo];
            if (!targetPattern) return;

            const currentPattern = this.analyzeHandPattern(landmarks);
            
            // ë””ë²„ê¹…: í˜„ì¬ ì† ì¸ì‹ ìƒíƒœ ì¶œë ¥
            console.log('=== ì† ì¸ì‹ ë””ë²„ê¹… ===');
            console.log('í˜„ì¬ ìëª¨ìŒ:', currentJamo);
            console.log('ëª©í‘œ íŒ¨í„´:', targetPattern);
            console.log('í˜„ì¬ íŒ¨í„´:', currentPattern);
            
            // 1ë‹¨ê³„: ì†ê°€ë½ ëª¨ì–‘ ê²€ì‚¬
            let isShapeCorrect = Object.keys(targetPattern).every(finger => 
                finger === 'description' || finger === 'palmDirection' || finger === 'relativePosition' || 
                targetPattern[finger] === currentPattern[finger]
            );
            console.log('1ë‹¨ê³„ - ì†ê°€ë½ ëª¨ì–‘ ê²€ì‚¬:', isShapeCorrect);

            // 2ë‹¨ê³„: ì†ë°”ë‹¥ ë°©í–¥ ê²€ì‚¬ (ì •í™•ë„ í–¥ìƒì„ ìœ„í•´ ë¹„í™œì„±í™”)
            let palmDirectionCorrect = true;
            console.log('2ë‹¨ê³„ - ì†ë°”ë‹¥ ë°©í–¥ ê²€ì‚¬: ë¹„í™œì„±í™”ë¨ (ìš”êµ¬:', targetPattern.palmDirection, ')');

            // 3ë‹¨ê³„: ì†ê°€ë½ ìƒëŒ€ ìœ„ì¹˜ ê²€ì‚¬ (ìƒˆë¡œìš´ ê¸°ëŠ¥)
            let relativePositionCorrect = true;
            if (isShapeCorrect && targetPattern.relativePosition && targetPattern.relativePosition !== 'any') {
                relativePositionCorrect = this.checkRelativePosition(landmarks, targetPattern.relativePosition);
                console.log('3ë‹¨ê³„ - ì†ê°€ë½ ìƒëŒ€ ìœ„ì¹˜ ê²€ì‚¬:', relativePositionCorrect, '(ìš”êµ¬:', targetPattern.relativePosition, ')');
                if (!relativePositionCorrect) {
                    isShapeCorrect = false;
                }
            }
            
            console.log('ìµœì¢… ê²°ê³¼:', isShapeCorrect ? 'ì •ë‹µ' : 'ì˜¤ë‹µ');
            console.log('========================');

            this.practiceCount++;
            if (isShapeCorrect) {
                this.isProcessingCorrect = true; // ì •ë‹µ ì²˜ë¦¬ ì‹œì‘
                this.showFeedback('ì •í™•í•©ë‹ˆë‹¤! ğŸ‘', 'correct');
                this.learnedLetters.add(currentJamo);
                this.correctCount++;
                // ì •ë‹µ ë©”ì‹œì§€ë¥¼ 2ì´ˆê°„ ë³´ì—¬ì£¼ê³  ë‹¤ìŒ ìëª¨ìŒìœ¼ë¡œ ë„˜ì–´ê°
                setTimeout(() => { 
                    this.hideFeedback();
                    setTimeout(() => { 
                        this.nextJamo();
                        this.isProcessingCorrect = false; // ì •ë‹µ ì²˜ë¦¬ ì™„ë£Œ
                    }, 500); // ì¶”ê°€ë¡œ 0.5ì´ˆ ëŒ€ê¸°
                }, 2000);
            } else {
                this.showFeedback('ëª¨ì–‘ì´ë‚˜ ë°©í–¥ì´ ë‹¬ë¼ìš”. ë‹¤ì‹œ ì‹œë„í•´ ë³´ì„¸ìš”.', 'incorrect');
            }
        }

        analyzeHandPattern(landmarks) {
            return {
                thumb: this.getThumbState(landmarks),
                index: this.getFingerState(landmarks, 8, 6),
                middle: this.getFingerState(landmarks, 12, 10),
                ring: this.getFingerState(landmarks, 16, 14),
                pinky: this.getFingerState(landmarks, 20, 18)
            };
        }

        getFingerState(landmarks, tipIndex, dipIndex) {
            const tipY = landmarks[tipIndex].y;
            const dipY = landmarks[dipIndex].y;
            const mcpY = landmarks[dipIndex - 1].y; // MCP ê´€ì ˆ (ì†ë°”ë‹¥ê³¼ ì—°ê²°ë˜ëŠ” ê´€ì ˆ)
            
            // ì†ê°€ë½ ëì´ DIP ê´€ì ˆë³´ë‹¤ ìœ„ì— ìˆìœ¼ë©´ í´ì§„ ìƒíƒœ
            if (tipY < dipY - 0.02) {
                return 'extended';
            }
            // ì†ê°€ë½ ëì´ MCP ê´€ì ˆë³´ë‹¤ ì•„ë˜ì— ìˆìœ¼ë©´ êµ¬ë¶€ëŸ¬ì§„ ìƒíƒœ
            else if (tipY > mcpY + 0.02) {
                return 'bent';
            }
            // ê·¸ ì‚¬ì´ì— ìˆìœ¼ë©´ í´ì§„ ìƒíƒœë¡œ ê°„ì£¼ (halfbent ì œê±°)
            else {
                return 'extended';
            }
        }

        getThumbState(landmarks) {
            const thumbTip = landmarks[4]; // ì—„ì§€ ë
            const indexMcp = landmarks[5]; // ê²€ì§€ MCP ê´€ì ˆ (ê²€ì§€ ì‹œì‘ì )
            const middleMcp = landmarks[9]; // ì¤‘ì§€ MCP ê´€ì ˆ
            const ringMcp = landmarks[13]; // ì•½ì§€ MCP ê´€ì ˆ
            const pinkyMcp = landmarks[17]; // ìƒˆë¼ì†ê°€ë½ MCP ê´€ì ˆ
            
            // ë””ë²„ê¹…: ì—„ì§€ ìƒíƒœ ì •ë³´ ì¶œë ¥
            console.log('ì—„ì§€ ë””ë²„ê¹…:', {
                thumbTipX: thumbTip.x.toFixed(3), thumbTipY: thumbTip.y.toFixed(3),
                indexMcpX: indexMcp.x.toFixed(3), indexMcpY: indexMcp.y.toFixed(3),
                dominantHand: this.dominantHand
            });
            
            // ì—„ì§€ ëì´ ê²€ì§€ ì‹œì‘ì (MCP)ì— ê°€ê¹Œìš´ì§€ í™•ì¸
            const distanceToIndexMcp = Math.sqrt(
                Math.pow(thumbTip.x - indexMcp.x, 2) + 
                Math.pow(thumbTip.y - indexMcp.y, 2)
            );
            
            // ì—„ì§€ ëì´ ê²€ì§€ ì‹œì‘ì ì— ê°€ê¹Œìš°ë©´ êµ¬ë¶€ëŸ¬ì§„ ìƒíƒœ
            if (distanceToIndexMcp < 0.08) {
                console.log('ì—„ì§€ ìƒíƒœ: bent (ê²€ì§€ MCPê³¼ì˜ ê±°ë¦¬:', distanceToIndexMcp.toFixed(3), ')');
                return 'bent';
            } else {
                console.log('ì—„ì§€ ìƒíƒœ: extended (ê²€ì§€ MCPê³¼ì˜ ê±°ë¦¬:', distanceToIndexMcp.toFixed(3), ')');
                return 'extended';
            }
        }

        /**
         * ì†ë°”ë‹¥ ë°©í–¥ ê²€ì‚¬ í•¨ìˆ˜
         * @param {Array} landmarks - MediaPipe ì† ëœë“œë§ˆí¬ ë°°ì—´
         * @param {string} requiredDirection - ìš”êµ¬ë˜ëŠ” ë°©í–¥ ('forward', 'backward', 'side', 'up', 'down')
         * @returns {boolean} - ë°©í–¥ì´ ì˜¬ë°”ë¥¸ì§€ ì—¬ë¶€
         * 
         * ì‘ë™ ë°©ì‹:
         * 1. calculatePalmNormal()ë¡œ ì†ë°”ë‹¥ì˜ ë²•ì„ ë²¡í„° ê³„ì‚°
         * 2. ë²•ì„ ë²¡í„°ì˜ x, y, z ì„±ë¶„ì„ ë¶„ì„í•˜ì—¬ ë°©í–¥ íŒë³„
         * 3. threshold ê°’ì„ ì‚¬ìš©í•˜ì—¬ ë°©í–¥ì˜ ì •í™•ë„ ì¡°ì ˆ
         */
        checkPalmDirection(landmarks, requiredDirection) {
            const normal = this.calculatePalmNormal(landmarks);
            const threshold = 0.5; // ë°©í–¥ íŒë³„ ì„ê³„ê°’ (ë‚®ì„ìˆ˜ë¡ ì—„ê²©)

            // ë””ë²„ê¹…: ì†ë°”ë‹¥ ë°©í–¥ ì •ë³´ ì¶œë ¥
            console.log('ì†ë°”ë‹¥ ë²•ì„ ë²¡í„°:', { x: normal.x.toFixed(3), y: normal.y.toFixed(3), z: normal.z.toFixed(3) });
            console.log('ì£¼ ì‚¬ìš© ì†:', this.dominantHand);

            let result = false;
            switch (requiredDirection) {
                case 'forward':
                    // ì†ë°”ë‹¥ì´ ì¹´ë©”ë¼ë¥¼ í–¥í•¨ (ë²•ì„ ë²¡í„°ê°€ ì¹´ë©”ë¼ ë°˜ëŒ€ ë°©í–¥)
                    result = (this.dominantHand === 'right') ? 
                        (normal.x < -threshold) : (normal.x > threshold);
                    console.log('forward ê²€ì‚¬:', result, '(normal.x:', normal.x.toFixed(3), ', threshold:', threshold, ')');
                    break;
                
                case 'backward':
                    // ì†ë“±ì´ ì¹´ë©”ë¼ë¥¼ í–¥í•¨ (ë²•ì„ ë²¡í„°ê°€ ì¹´ë©”ë¼ ë°©í–¥)
                    result = (this.dominantHand === 'right') ? 
                        (normal.x > threshold) : (normal.x < -threshold);
                    console.log('backward ê²€ì‚¬:', result, '(normal.x:', normal.x.toFixed(3), ', threshold:', threshold, ')');
                    break;
                
                case 'side':
                    // ì†ì˜ ì˜†ë©´ì´ ì¹´ë©”ë¼ë¥¼ í–¥í•¨ (ë²•ì„ ë²¡í„°ì˜ xì„±ë¶„ì´ ì‘ìŒ)
                    result = Math.abs(normal.x) < threshold;
                    console.log('side ê²€ì‚¬:', result, '(|normal.x|:', Math.abs(normal.x).toFixed(3), ', threshold:', threshold, ')');
                    break;
                
                case 'up':
                    // ì†ë°”ë‹¥ì´ ìœ„ë¥¼ í–¥í•¨ (ë²•ì„ ë²¡í„°ì˜ yì„±ë¶„ì´ ìŒìˆ˜)
                    result = normal.y < -threshold;
                    console.log('up ê²€ì‚¬:', result, '(normal.y:', normal.y.toFixed(3), ', threshold:', threshold, ')');
                    break;
                
                case 'down':
                    // ì†ë°”ë‹¥ì´ ì•„ë˜ë¥¼ í–¥í•¨ (ë²•ì„ ë²¡í„°ì˜ yì„±ë¶„ì´ ì–‘ìˆ˜)
                    result = normal.y > threshold;
                    console.log('down ê²€ì‚¬:', result, '(normal.y:', normal.y.toFixed(3), ', threshold:', threshold, ')');
                    break;
                
                default:
                    result = true; // 'any' ë˜ëŠ” ì•Œ ìˆ˜ ì—†ëŠ” ë°©í–¥
                    console.log('any ë°©í–¥:', result);
            }
            
            return result;
        }

        /**
         * ì†ê°€ë½ ìƒëŒ€ ìœ„ì¹˜ ê²€ì‚¬ í•¨ìˆ˜
         * @param {Array} landmarks - MediaPipe ì† ëœë“œë§ˆí¬ ë°°ì—´
         * @param {string} requiredPosition - ìš”êµ¬ë˜ëŠ” ìƒëŒ€ ìœ„ì¹˜ ('straight', 'spread', 'closed', 'specific')
         * @returns {boolean} - ìƒëŒ€ ìœ„ì¹˜ê°€ ì˜¬ë°”ë¥¸ì§€ ì—¬ë¶€
         * 
         * ì‘ë™ ë°©ì‹:
         * 1. ì†ê°€ë½ ëì ë“¤(landmarks 4, 8, 12, 16, 20)ì˜ ì¢Œí‘œ ì¶”ì¶œ
         * 2. ì†ê°€ë½ë“¤ ê°„ì˜ ê±°ë¦¬ì™€ ê°ë„ ê³„ì‚°
         * 3. íŒ¨í„´ë³„ë¡œ ë‹¤ë¥¸ ê¸°ì¤€ ì ìš©
         */
        checkRelativePosition(landmarks, requiredPosition) {
            const fingerTips = [4, 8, 12, 16, 20]; // ì—„ì§€, ê²€ì§€, ì¤‘ì§€, ì•½ì§€, ìƒˆë¼ì†ê°€ë½ ë
            const fingerPositions = fingerTips.map(i => landmarks[i]);

            switch (requiredPosition) {
                case 'straight':
                    // ì†ê°€ë½ë“¤ì´ ì¼ì§ì„ ìƒì— ë°°ì¹˜ë¨ (ì˜†ëª¨ìŠµì—ì„œ ì£¼ë¡œ ë‚˜íƒ€ë‚¨)
                    return this.checkFingerAlignment(fingerPositions);
                
                case 'spread':
                    // ì†ê°€ë½ë“¤ì´ ë²Œì–´ì ¸ ìˆìŒ
                    return this.checkFingerSpread(fingerPositions);
                
                case 'closed':
                    // ì†ê°€ë½ë“¤ì´ ëª¨ì—¬ìˆìŒ
                    return this.checkFingerClosed(fingerPositions);
                
                case 'specific':
                    // íŠ¹ì • íŒ¨í„´ (ê° ìëª¨ìŒë³„ë¡œ ê°œë³„ ê²€ì‚¬)
                    return this.checkSpecificPattern(landmarks, fingerPositions);
                
                default:
                    return true; // 'any' ë˜ëŠ” ì•Œ ìˆ˜ ì—†ëŠ” íŒ¨í„´
            }
        }

        /**
         * ì†ê°€ë½ë“¤ì´ ì¼ì§ì„ ìƒì— ë°°ì¹˜ë˜ì—ˆëŠ”ì§€ ê²€ì‚¬
         * ì˜†ëª¨ìŠµì—ì„œ ì†ê°€ë½ ëì ë“¤ì´ ê±°ì˜ ì¼ì§ì„ ìƒì— ìˆì„ ë•Œ true
         */
        checkFingerAlignment(fingerPositions) {
            // ì†ê°€ë½ ëì ë“¤ì˜ yì¢Œí‘œê°€ ë¹„ìŠ·í•œì§€ í™•ì¸ (ìˆ˜í‰ì„ ìƒ ë°°ì¹˜)
            const yPositions = fingerPositions.map(pos => pos.y);
            const yVariance = this.calculateVariance(yPositions);
            return yVariance < 0.01; // ì„ê³„ê°’ ì¡°ì • ê°€ëŠ¥
        }

        /**
         * ì†ê°€ë½ë“¤ì´ ë²Œì–´ì ¸ ìˆëŠ”ì§€ ê²€ì‚¬
         * í´ì§„ ì†ê°€ë½ë“¤ë§Œ ê³ ë ¤í•˜ì—¬ ë²Œì–´ì ¸ ìˆëŠ”ì§€ í™•ì¸
         */
        checkFingerSpread(fingerPositions) {
            if (this.currentSyllableIndex >= this.decomposedSyllables.length) return true;
            
            const currentJamo = this.decomposedSyllables[this.currentSyllableIndex].jamos[this.currentJamoTypeIndex];
            const targetPattern = this.signPatterns[currentJamo];
            
            if (!targetPattern) return true;
            
            // í´ì§„ ì†ê°€ë½ë“¤ë§Œ ì¶”ì¶œ
            const extendedFingers = [];
            const fingerIndices = [4, 8, 12, 16, 20]; // ì—„ì§€, ê²€ì§€, ì¤‘ì§€, ì•½ì§€, ìƒˆë¼ì†ê°€ë½ ë
            const fingerNames = ['thumb', 'index', 'middle', 'ring', 'pinky'];
            
            for (let i = 0; i < fingerNames.length; i++) {
                const fingerName = fingerNames[i];
                const fingerState = targetPattern[fingerName];
                
                // í´ì§„ ì†ê°€ë½ë§Œ í¬í•¨ (extended)
                if (fingerState === 'extended') {
                    extendedFingers.push(fingerPositions[i]);
                }
            }
            
            // í´ì§„ ì†ê°€ë½ì´ 2ê°œ ë¯¸ë§Œì´ë©´ spread ê²€ì‚¬ ë¶ˆí•„ìš”
            if (extendedFingers.length < 2) {
                return true;
            }
            
            // í´ì§„ ì†ê°€ë½ë“¤ ê°„ì˜ í‰ê·  ê±°ë¦¬ ê³„ì‚°
            const distances = [];
            for (let i = 0; i < extendedFingers.length - 1; i++) {
                const dist = this.calculateDistance(extendedFingers[i], extendedFingers[i + 1]);
                distances.push(dist);
            }
            
            const avgDistance = distances.reduce((sum, dist) => sum + dist, 0) / distances.length;
            return avgDistance > 0.05; // ì„ê³„ê°’ ì¡°ì • ê°€ëŠ¥
        }

        /**
         * ì†ê°€ë½ë“¤ì´ ëª¨ì—¬ìˆëŠ”ì§€ ê²€ì‚¬
         * í´ì§„ ì†ê°€ë½ë“¤ë§Œ ê³ ë ¤í•˜ì—¬ ëª¨ì—¬ìˆëŠ”ì§€ í™•ì¸
         */
        checkFingerClosed(fingerPositions) {
            if (this.currentSyllableIndex >= this.decomposedSyllables.length) return true;
            
            const currentJamo = this.decomposedSyllables[this.currentSyllableIndex].jamos[this.currentJamoTypeIndex];
            const targetPattern = this.signPatterns[currentJamo];
            
            if (!targetPattern) return true;
            
            // í´ì§„ ì†ê°€ë½ë“¤ë§Œ ì¶”ì¶œ
            const extendedFingers = [];
            const fingerIndices = [4, 8, 12, 16, 20]; // ì—„ì§€, ê²€ì§€, ì¤‘ì§€, ì•½ì§€, ìƒˆë¼ì†ê°€ë½ ë
            const fingerNames = ['thumb', 'index', 'middle', 'ring', 'pinky'];
            
            for (let i = 0; i < fingerNames.length; i++) {
                const fingerName = fingerNames[i];
                const fingerState = targetPattern[fingerName];
                
                // í´ì§„ ì†ê°€ë½ë§Œ í¬í•¨ (extended)
                if (fingerState === 'extended') {
                    extendedFingers.push(fingerPositions[i]);
                }
            }
            
            // í´ì§„ ì†ê°€ë½ì´ 2ê°œ ë¯¸ë§Œì´ë©´ closed ê²€ì‚¬ ë¶ˆí•„ìš”
            if (extendedFingers.length < 2) {
                return true;
            }
            
            // í´ì§„ ì†ê°€ë½ë“¤ ê°„ì˜ í‰ê·  ê±°ë¦¬ ê³„ì‚°
            const distances = [];
            for (let i = 0; i < extendedFingers.length - 1; i++) {
                const dist = this.calculateDistance(extendedFingers[i], extendedFingers[i + 1]);
                distances.push(dist);
            }
            
            const avgDistance = distances.reduce((sum, dist) => sum + dist, 0) / distances.length;
            return avgDistance < 0.08; // ì„ê³„ê°’ì„ 0.03ì—ì„œ 0.08ë¡œ ì¦ê°€ (ë” ê´€ëŒ€í•˜ê²Œ)
        }

        /**
         * íŠ¹ì • íŒ¨í„´ ê²€ì‚¬ (ê° ìëª¨ìŒë³„ ê°œë³„ ë¡œì§)
         * í˜„ì¬ëŠ” ì •í™•ë„ í–¥ìƒì„ ìœ„í•´ ë¹„í™œì„±í™”ë¨
         */
        checkSpecificPattern(landmarks, fingerPositions) {
            // specific íŒ¨í„´ ê²€ì‚¬ë¥¼ ë¹„í™œì„±í™”í•˜ì—¬ ì •í™•ë„ í–¥ìƒ
            return true;
        }

        /**
         * ì—„ì§€ì™€ ê²€ì§€ ëì´ ë§Œë‚˜ì„œ ë™ê·¸ë¼ë¯¸ë¥¼ í˜•ì„±í•˜ëŠ”ì§€ ê²€ì‚¬
         */
        checkThumbIndexTouch(landmarks) {
            const thumbTip = landmarks[4];  // ì—„ì§€ ë
            const indexTip = landmarks[8]; // ê²€ì§€ ë
            const distance = this.calculateDistance(thumbTip, indexTip);
            return distance < 0.02; // ì„ê³„ê°’: ë§¤ìš° ê°€ê¹Œì›Œì•¼ í•¨
        }

        /**
         * ëª¨ë“  ì†ê°€ë½ì„ ë°˜ë§Œ ì ‘ê³  ìˆëŠ”ì§€ ê²€ì‚¬
         */
        checkAllHalfBent(landmarks) {
            const thumbState = this.getThumbState(landmarks);
            const indexState = this.getFingerState(landmarks, 8, 6);
            const middleState = this.getFingerState(landmarks, 12, 10);
            const ringState = this.getFingerState(landmarks, 16, 14);
            const pinkyState = this.getFingerState(landmarks, 20, 18);
            
            // ëª¨ë“  ì†ê°€ë½ì´ halfbent ìƒíƒœì—¬ì•¼ í•¨
            return thumbState === 'extended' && 
                   indexState === 'halfbent' && 
                   middleState === 'halfbent' && 
                   ringState === 'halfbent' && 
                   pinkyState === 'halfbent';
        }

        /**
         * ìƒˆë¼ì†ê°€ë½ë§Œ êµ¬ë¶€ë¦°ì±„ë¡œ ë‚˜ë¨¸ì§€ ì†ê°€ë½ì„ í´ëŠ”ì§€ ê²€ì‚¬
         */
        checkAllExceptPinky(landmarks) {
            const thumbState = this.getThumbState(landmarks);
            const indexState = this.getFingerState(landmarks, 8, 6);
            const middleState = this.getFingerState(landmarks, 12, 10);
            const ringState = this.getFingerState(landmarks, 16, 14);
            const pinkyState = this.getFingerState(landmarks, 20, 18);
            
            // ìƒˆë¼ì†ê°€ë½ì€ êµ¬ë¶€ë ¤ì•¼ í•˜ê³ , ë‚˜ë¨¸ì§€ëŠ” í´ì ¸ì•¼ í•¨
            return (thumbState === 'extended') && 
                   (indexState === 'extended' || indexState === 'extended') && 
                   (middleState === 'extended' || middleState === 'extended') && 
                   (ringState === 'extended' || ringState === 'extended') && 
                   (pinkyState === 'bent' || pinkyState === 'extended');
        }

        /**
         * ê²€ì§€, ì¤‘ì§€, ì•½ì§€ë¥¼ í´ê³  ì¤‘ì§€ì™€ ì•½ì§€ëŠ” ë¶™ì¸ ìƒíƒœì¸ì§€ ê²€ì‚¬
         */
        checkIndexMiddleRingClose(landmarks) {
            const indexState = this.getFingerState(landmarks, 8, 6);
            const middleState = this.getFingerState(landmarks, 12, 10);
            const ringState = this.getFingerState(landmarks, 16, 14);
            const thumbState = this.getThumbState(landmarks);
            const pinkyState = this.getFingerState(landmarks, 20, 18);
            
            // ê²€ì§€, ì¤‘ì§€, ì•½ì§€ëŠ” í´ì ¸ì•¼ í•˜ê³ , ì—„ì§€ì™€ ìƒˆë¼ì†ê°€ë½ì€ êµ¬ë¶€ë ¤ì•¼ í•¨
            const fingersCorrect = (indexState === 'extended' || indexState === 'extended') && 
                                  (middleState === 'extended' || middleState === 'extended') && 
                                  (ringState === 'extended' || ringState === 'extended') && 
                                  (thumbState === 'bent') && 
                                  (pinkyState === 'bent' || pinkyState === 'extended');
            
            if (!fingersCorrect) return false;
            
            // ì¤‘ì§€ì™€ ì•½ì§€ê°€ ë¶™ì–´ìˆëŠ”ì§€ ì¶”ê°€ ê²€ì‚¬
            const middleTip = landmarks[12];
            const ringTip = landmarks[16];
            const distance = this.calculateDistance(middleTip, ringTip);
            return distance < 0.03; // ì¤‘ì§€ì™€ ì•½ì§€ê°€ ê°€ê¹Œì´ ë¶™ì–´ìˆì–´ì•¼ í•¨
        }


        /**
         * ê²€ì§€ì™€ ì—„ì§€ë§Œ í´ê³  ë‚˜ë¨¸ì§€ëŠ” êµ¬ë¶€ë¦° ìƒíƒœì¸ì§€ ê²€ì‚¬
         */
        checkIndexThumbOnly(landmarks) {
            const indexState = this.getFingerState(landmarks, 8, 6);
            const thumbState = this.getThumbState(landmarks);
            const middleState = this.getFingerState(landmarks, 12, 10);
            const ringState = this.getFingerState(landmarks, 16, 14);
            const pinkyState = this.getFingerState(landmarks, 20, 18);
            
            // ê²€ì§€ì™€ ì—„ì§€ëŠ” í´ì ¸ì•¼ í•˜ê³ , ë‚˜ë¨¸ì§€ëŠ” êµ¬ë¶€ëŸ¬ì ¸ì•¼ í•¨
            return (indexState === 'extended' || indexState === 'extended') && 
                   (thumbState === 'extended' || thumbState === 'extended') && 
                   (middleState === 'bent' || middleState === 'extended') && 
                   (ringState === 'bent' || ringState === 'extended') && 
                   (pinkyState === 'bent' || pinkyState === 'extended');
        }

        /**
         * ê²€ì§€ì™€ ì¤‘ì§€ë§Œ í´ê³  ë‚˜ë¨¸ì§€ëŠ” êµ¬ë¶€ë¦° ìƒíƒœì¸ì§€ ê²€ì‚¬
         */
        checkIndexMiddleOnly(landmarks) {
            const indexState = this.getFingerState(landmarks, 8, 6);
            const middleState = this.getFingerState(landmarks, 12, 10);
            const thumbState = this.getThumbState(landmarks);
            const ringState = this.getFingerState(landmarks, 16, 14);
            const pinkyState = this.getFingerState(landmarks, 20, 18);
            
            // ê²€ì§€ì™€ ì¤‘ì§€ëŠ” í´ì ¸ì•¼ í•˜ê³ , ë‚˜ë¨¸ì§€ëŠ” êµ¬ë¶€ëŸ¬ì ¸ì•¼ í•¨
            return (indexState === 'extended' || indexState === 'extended') && 
                   (middleState === 'extended' || middleState === 'extended') && 
                   (thumbState === 'bent') && 
                   (ringState === 'bent' || ringState === 'extended') && 
                   (pinkyState === 'bent' || pinkyState === 'extended');
        }

        /**
         * ìƒˆë¼ì†ê°€ë½ë§Œ í´ê³  ë‚˜ë¨¸ì§€ëŠ” êµ¬ë¶€ë¦° ìƒíƒœì¸ì§€ ê²€ì‚¬
         */
        checkPinkyOnly(landmarks) {
            const pinkyState = this.getFingerState(landmarks, 20, 18);
            const thumbState = this.getThumbState(landmarks);
            const indexState = this.getFingerState(landmarks, 8, 6);
            const middleState = this.getFingerState(landmarks, 12, 10);
            const ringState = this.getFingerState(landmarks, 16, 14);
            
            // ìƒˆë¼ì†ê°€ë½ì€ í´ì ¸ì•¼ í•˜ê³ , ë‚˜ë¨¸ì§€ëŠ” êµ¬ë¶€ëŸ¬ì ¸ì•¼ í•¨
            return (pinkyState === 'extended' || pinkyState === 'extended') && 
                   (thumbState === 'bent') && 
                   (indexState === 'bent' || indexState === 'extended') && 
                   (middleState === 'bent' || middleState === 'extended') && 
                   (ringState === 'bent' || ringState === 'extended');
        }

        /**
         * ê²€ì§€ë§Œ í´ê³  ë‚˜ë¨¸ì§€ëŠ” êµ¬ë¶€ë¦° ìƒíƒœì¸ì§€ ê²€ì‚¬
         */
        checkIndexOnly(landmarks) {
            const indexState = this.getFingerState(landmarks, 8, 6);
            const thumbState = this.getThumbState(landmarks);
            const middleState = this.getFingerState(landmarks, 12, 10);
            const ringState = this.getFingerState(landmarks, 16, 14);
            const pinkyState = this.getFingerState(landmarks, 20, 18);
            
            // ê²€ì§€ëŠ” í´ì ¸ì•¼ í•˜ê³ , ë‚˜ë¨¸ì§€ëŠ” êµ¬ë¶€ëŸ¬ì ¸ì•¼ í•¨
            return (indexState === 'extended' || indexState === 'extended') && 
                   (thumbState === 'bent') && 
                   (middleState === 'bent' || middleState === 'extended') && 
                   (ringState === 'bent' || ringState === 'extended') && 
                   (pinkyState === 'bent' || pinkyState === 'extended');
        }

        /**
         * ì—„ì§€ë§Œ í´ê³  ë‚˜ë¨¸ì§€ëŠ” êµ¬ë¶€ë¦° ìƒíƒœì¸ì§€ ê²€ì‚¬
         */
        checkThumbOnly(landmarks) {
            const thumbState = this.getThumbState(landmarks);
            const indexState = this.getFingerState(landmarks, 8, 6);
            const middleState = this.getFingerState(landmarks, 12, 10);
            const ringState = this.getFingerState(landmarks, 16, 14);
            const pinkyState = this.getFingerState(landmarks, 20, 18);
            
            // ì—„ì§€ëŠ” í´ì ¸ì•¼ í•˜ê³ , ë‚˜ë¨¸ì§€ëŠ” êµ¬ë¶€ëŸ¬ì ¸ì•¼ í•¨
            return (thumbState === 'extended') && 
                   (indexState === 'bent' || indexState === 'extended') && 
                   (middleState === 'bent' || middleState === 'extended') && 
                   (ringState === 'bent' || ringState === 'extended') && 
                   (pinkyState === 'bent' || pinkyState === 'extended');
        }

        /**
         * ì—„ì§€ì™€ ê²€ì§€ë§Œ í´ê³  ë‚˜ë¨¸ì§€ëŠ” êµ¬ë¶€ë¦° ìƒíƒœì¸ì§€ ê²€ì‚¬
         */
        checkThumbIndexOnly(landmarks) {
            const thumbState = this.getThumbState(landmarks);
            const indexState = this.getFingerState(landmarks, 8, 6);
            const middleState = this.getFingerState(landmarks, 12, 10);
            const ringState = this.getFingerState(landmarks, 16, 14);
            const pinkyState = this.getFingerState(landmarks, 20, 18);
            
            // ì—„ì§€ì™€ ê²€ì§€ëŠ” í´ì ¸ì•¼ í•˜ê³ , ë‚˜ë¨¸ì§€ëŠ” êµ¬ë¶€ëŸ¬ì ¸ì•¼ í•¨
            return (thumbState === 'extended') && 
                   (indexState === 'extended' || indexState === 'extended') && 
                   (middleState === 'bent' || middleState === 'extended') && 
                   (ringState === 'bent' || ringState === 'extended') && 
                   (pinkyState === 'bent' || pinkyState === 'extended');
        }

        /**
         * ë‘ ì  ê°„ì˜ ê±°ë¦¬ ê³„ì‚°
         */
        calculateDistance(point1, point2) {
            const dx = point1.x - point2.x;
            const dy = point1.y - point2.y;
            const dz = point1.z - point2.z;
            return Math.sqrt(dx * dx + dy * dy + dz * dz);
        }

        /**
         * ë°°ì—´ì˜ ë¶„ì‚° ê³„ì‚°
         */
        calculateVariance(values) {
            const mean = values.reduce((sum, val) => sum + val, 0) / values.length;
            const variance = values.reduce((sum, val) => sum + Math.pow(val - mean, 2), 0) / values.length;
            return variance;
        }

        /**
         * ë°°ê²½ ìˆ˜í™” ì´ë¯¸ì§€ ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
         */
        startBackgroundAnimation() {
            // ê¸°ì¡´ ì• ë‹ˆë©”ì´ì…˜ ì •ë¦¬
            this.stopBackgroundAnimation();
            
            // 20ê°œì˜ ë°°ê²½ ìˆ˜í™” ì´ë¯¸ì§€ ìƒì„±
            this.createBackgroundSigns();
            
            // 2ì´ˆë§ˆë‹¤ ìƒˆë¡œìš´ ì´ë¯¸ì§€ê°€ ë‚˜íƒ€ë‚˜ë„ë¡ ì„¤ì •
            this.backgroundAnimationInterval = setInterval(() => {
                this.showRandomBackgroundSign();
            }, 2000);
        }

        /**
         * ë°°ê²½ ìˆ˜í™” ì´ë¯¸ì§€ ì• ë‹ˆë©”ì´ì…˜ ì¤‘ì§€
         */
        stopBackgroundAnimation() {
            if (this.backgroundAnimationInterval) {
                clearInterval(this.backgroundAnimationInterval);
                this.backgroundAnimationInterval = null;
            }
            
            // ëª¨ë“  ë°°ê²½ ì´ë¯¸ì§€ ì œê±°
            this.backgroundSignsContainer.innerHTML = '';
            this.backgroundSigns = [];
        }

        /**
         * 20ê°œì˜ ë°°ê²½ ìˆ˜í™” ì´ë¯¸ì§€ ìš”ì†Œ ìƒì„± (í˜„ì¬ ì—°ìŠµ ì¤‘ì¸ ìˆ˜í™”ë¡œ)
         */
        createBackgroundSigns() {
            // í˜„ì¬ ì—°ìŠµ ì¤‘ì¸ ìˆ˜í™” ê°€ì ¸ì˜¤ê¸°
            if (this.currentSyllableIndex >= this.decomposedSyllables.length) return;
            
            const currentJamo = this.decomposedSyllables[this.currentSyllableIndex].jamos[this.currentJamoTypeIndex];
            const imagePath = `images/signs/${currentJamo}.png`;
            
            for (let i = 0; i < 20; i++) {
                const signElement = document.createElement('div');
                signElement.className = 'background-sign';
                
                // í˜„ì¬ ì—°ìŠµ ì¤‘ì¸ ìˆ˜í™” ì´ë¯¸ì§€ ì‚¬ìš©
                const img = document.createElement('img');
                img.src = imagePath;
                img.alt = `ìˆ˜í™” ${currentJamo}`;
                
                // ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ê¸°ë³¸ í…ìŠ¤íŠ¸ í‘œì‹œ
                img.onerror = () => {
                    signElement.innerHTML = `<div style="display: flex; align-items: center; justify-content: center; height: 100%; font-size: 24px; color: #666;">${currentJamo}</div>`;
                };
                
                signElement.appendChild(img);
                
                // ëœë¤í•œ ìœ„ì¹˜ ì„¤ì • (í™”ë©´ ê²½ê³„ë¥¼ ê³ ë ¤)
                const x = Math.random() * (window.innerWidth - 80);
                const y = Math.random() * (window.innerHeight - 80);
                signElement.style.left = `${x}px`;
                signElement.style.top = `${y}px`;
                
                this.backgroundSignsContainer.appendChild(signElement);
                this.backgroundSigns.push(signElement);
            }
        }

        /**
         * ë™ì‹œë‹¤ë°œì ìœ¼ë¡œ ë°°ê²½ ìˆ˜í™” ì´ë¯¸ì§€ë“¤ì„ ë‚˜íƒ€ë‚˜ê²Œ í•¨
         */
        showRandomBackgroundSign() {
            if (this.backgroundSigns.length === 0) return;
            
            // ë³´ì´ì§€ ì•ŠëŠ” ì´ë¯¸ì§€ë“¤ ì¤‘ì—ì„œ ëœë¤í•˜ê²Œ 15-20ê°œ ì„ íƒ
            const hiddenSigns = this.backgroundSigns.filter(sign => !sign.classList.contains('fade-in'));
            const numToShow = Math.min(15 + Math.floor(Math.random() * 6), hiddenSigns.length); // 15-20ê°œ
            
            // ëœë¤í•˜ê²Œ ì„ íƒëœ ì´ë¯¸ì§€ë“¤ì„ ë™ì‹œì— ë‚˜íƒ€ë‚˜ê²Œ í•¨
            for (let i = 0; i < numToShow; i++) {
                const randomIndex = Math.floor(Math.random() * hiddenSigns.length);
                const selectedSign = hiddenSigns[randomIndex];
                
                // ì„ íƒëœ ì´ë¯¸ì§€ë¥¼ ë°°ì—´ì—ì„œ ì œê±°í•˜ì—¬ ì¤‘ë³µ ë°©ì§€
                hiddenSigns.splice(randomIndex, 1);
                
                selectedSign.classList.add('fade-in');
                
                // 3ì´ˆ í›„ì— ì‚¬ë¼ì§€ê²Œ í•¨
                setTimeout(() => {
                    selectedSign.classList.remove('fade-in');
                    selectedSign.classList.add('fade-out');
                    
                    // í˜ì´ë“œ ì•„ì›ƒ ì™„ë£Œ í›„ í´ë˜ìŠ¤ ì •ë¦¬
                    setTimeout(() => {
                        selectedSign.classList.remove('fade-out');
                    }, 2000);
                }, 3000);
            }
        }

        /**
         * í˜„ì¬ ì—°ìŠµ ì¤‘ì¸ ìëª¨ìŒì— ë§ê²Œ ë°°ê²½ ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸
         */
        updateBackgroundSigns() {
            // ê¸°ì¡´ ë°°ê²½ ì´ë¯¸ì§€ë“¤ ì œê±°
            this.backgroundSignsContainer.innerHTML = '';
            this.backgroundSigns = [];
            
            // ìƒˆë¡œìš´ ë°°ê²½ ì´ë¯¸ì§€ë“¤ ìƒì„±
            this.createBackgroundSigns();
        }
    }
    
    document.addEventListener('DOMContentLoaded', () => new KoreanSignLanguageLearner());
</script>
</body>
</html>
